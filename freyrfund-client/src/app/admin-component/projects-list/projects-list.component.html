<div class="admin-card">
  <div class="admin-card-header">
    <button class="btn-primary" *ngIf="!editing" (click)="startCreate()">Novo Projeto</button>
  </div>

  <!-- Lista de projetos -->
  <div *ngIf="!editing" class="admin-card-body">
    <table class="admin-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>T√≠tulo</th>
          <th>Descri√ß√£o</th>
          <th>Taxa (%)</th>
          <th>Prazo</th>
          <th>Meta</th>
          <th>Risco</th>
          <th>A√ß√µes</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of projects">
          <td>{{ p.id }}</td>
          <td class="ellipsis" [title]="p.title">{{ p.title }}</td>
          <td class="ellipsis" [title]="p.description">{{ p.description }}</td>
          <td>{{ formatPercent(p.rate) }}</td>
          <td>{{ p.term }}m</td>
          <td>{{ p.target | currency:'EUR':'symbol' }}</td>
          <td>
            {{ p.risk === 0 ? 'A - Seguro' : p.risk === 1 ? 'B - Moderado' : 'C - Arriscado' }}
          </td>
          <td class="actions">
            <button class="icon-btn" (click)="startEdit(p)">‚úèÔ∏è</button>
            <button class="icon-btn" (click)="remove(p.id!)" [disabled]="removingId === p.id">
              {{ removingId === p.id ? 'Removendo‚Ä¶' : 'üóëÔ∏è' }}
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Formul√°rio -->
  <div *ngIf="editing" class="admin-form-container">
    <h3>{{ form.value.id ? 'Editar' : 'Criar' }} Projeto</h3>
    <form [formGroup]="form" (ngSubmit)="save()">
      <input type="hidden" formControlName="id" />

      <label>T√≠tulo <input formControlName="title" /></label>
      <label>Descri√ß√£o <textarea formControlName="description" rows="3"></textarea></label>
      <label>Taxa de Juros (%) <input type="number" formControlName="rate" /></label>
      <label>N√≠vel de Risco
        <select formControlName="risk">
          <option [ngValue]="0">A - Seguro</option>
          <option [ngValue]="1">B - Moderado</option>
          <option [ngValue]="2">C - Arriscado</option>
        </select>
      </label>
      <label>Prazo (meses) <input type="number" formControlName="term" /></label>
      <label>Meta de Financiamento (EUR) <input type="number" formControlName="target" /></label>
      <label>Imagem do Projeto</label>
      <app-upload-image (imageUploaded)="onImageUploaded($event)"></app-upload-image>

      <div class="form-actions">
        <button type="submit" class="btn-primary" [disabled]="form.invalid">
          {{ form.value.id ? 'Atualizar' : 'Criar' }}
        </button>
        <button type="button" class="btn-secondary" (click)="cancel()">Cancelar</button>
      </div>
    </form>
  </div>
</div>
